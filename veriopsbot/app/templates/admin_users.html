{% extends "layout.html" %}

{% block title %}Admin · VeriOps{% endblock %}

{% block header %}{% endblock %}

{% block header_actions %}
<span class="text-white-50 small me-3">{{ user_email }}</span>
<a href="/admin/tenants" class="btn btn-outline-light btn-sm me-2">Tenants</a>
<a href="/settings" class="btn btn-outline-light btn-sm me-2">Settings</a>
<a href="/logout" class="btn btn-outline-light btn-sm">Log out</a>
{% endblock %}

{% block content %}
<div class="portal-hero mb-4">
    <div class="row align-items-center g-4">
        <div class="col-lg-12">
            <span class="portal-pill"><i class="bi bi-shield-lock me-1"></i>Admin console</span>
            <p>Reset client credentials safely. Provide the user’s email, then supply a new email and/or password.</p>
        </div>
    </div>
</div>

{% if message %}
<div class="alert alert-success alert-dismissible fade show d-flex align-items-center gap-2" role="alert">
    <svg class="flex-shrink-0" width="20" height="20" aria-hidden="true">
        <use xlink:href="#portal-info-icon"></use>
    </svg>
    <div>{{ message }}</div>
    <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
{% endif %}
{% if errors %}
<div class="alert alert-danger">
    <ul class="mb-0">
        {% for error in errors %}
        <li>{{ error }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}

<div class="portal-card portal-card--glass">
    <form method="post" action="/admin/users" class="d-grid gap-3" data-loading-modal="true" autocomplete="off">
        <div class="form-group">
            <label for="target_email" class="form-label">Client email <span class="portal-required">*</span></label>
            <input id="target_email" name="target_email" type="email" class="form-control portal-input" required
                placeholder="client@example.com" value="{{ form_data.target_email or '' }}">
        </div>
        <div class="row g-3">
            <div class="col-md-6">
                <label for="new_email" class="form-label">New email</label>
                <input id="new_email" name="new_email" type="email" class="form-control portal-input"
                    placeholder="client@newdomain.com" value="{{ form_data.new_email or '' }}">
                <div class="settings-field-hint">Leave blank to keep their current email.</div>
            </div>
            <div class="col-md-6">
                <label for="new_password" class="form-label">New password</label>
                <input id="new_password" name="new_password" type="password" class="form-control portal-input"
                    minlength="8" placeholder="••••••••">
                <div class="settings-field-hint">Leave blank to keep their current password.</div>
            </div>
        </div>
        <div class="row g-3">
            <div class="col-md-6">
                <label for="confirm_new_password" class="form-label">Confirm new password</label>
                <input id="confirm_new_password" name="confirm_new_password" type="password"
                    class="form-control portal-input" minlength="8" placeholder="Re-enter password">
            </div>
        </div>
        <div class="portal-form-actions portal-form-actions--simple">
            <button type="submit" class="btn btn-primary">Update client credentials</button>
        </div>
    </form>
</div>
{% endblock %}