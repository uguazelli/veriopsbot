name: veriops

services:
  app:
    build:
      context: .
    container_name: veriopsbot
    command:
      - uv
      - run
      - uvicorn
      - app.main:app
      - --host
      - 0.0.0.0
      - --port
      - "8080"
      - --reload
    env_file:
      - .env
    environment:
      # Leave DATABASE_URL empty by default since we're removing Postgres from this stack.
      # If your app *requires* it, set an external DB in .env, e.g. a managed Postgres.
      DATABASE_URL: ${DATABASE_URL:-}
      CHATWOOT_BOT_ACCESS_TOKEN: ${CHATWOOT_BOT_ACCESS_TOKEN:-nS7yBjTg66L29cSUVypLQnGB}
      CHATWOOT_API_URL: ${CHATWOOT_API_URL:-http://localhost:3000/api/v1}
      # If your bot calls n8n webhooks, expose the base here for convenience:
      N8N_BASE_URL: ${N8N_BASE_URL:-http://localhost:5678}
    extra_hosts:
      # Docker for Linux does not provide host.docker.internal automatically, map it manually.
      - "host.docker.internal:host-gateway"
    ports:
      - "8080:8080"
    volumes:
      - .:/workspace
    working_dir: /workspace
    stdin_open: true
    tty: true
    depends_on: []
    networks:
      - veridata.network

networks:
  veridata.network:
    external: true
