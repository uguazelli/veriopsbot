<tr>
    <td style="font-weight: 500; font-family: monospace;">{{ mapping.instance_name }}</td>
    <td>
        <!-- Global Toggle Button -->
        <button hx-post="/admin/mappings/toggle_global/{{ mapping.instance_name }}" hx-target="closest tr"
            hx-swap="outerHTML" class="btn btn-sm btn-secondary" style="min-width: 80px; white-space: nowrap;"
            title="Toggle Global Bot Status">
            {% if mapping.is_active is false %}
            ⛔ STOP
            {% else %}
            ✅ RUN
            {% endif %}
        </button>
    </td>
    <td>
        <span style="font-feature-settings: 'tnum';">{{ mapping.messages_used }} / {{ mapping.message_limit }}</span>
        <div style="background: #e2e8f0; height: 4px; width: 100%; margin-top: 4px; border-radius: 2px;">
            {% set pct = mapping.messages_used / mapping.message_limit * 100 if mapping.message_limit > 0 else 0 %}
            <div
                style="background: var(--primary-color); height: 100%; width: {{ pct }}%; max-width: 100%; border-radius: 2px;">
            </div>
        </div>
    </td>
    <td style="font-size: 0.9em; color: var(--text-muted);">{{ mapping.renewal_date }}</td>
    <td>
        {% if mapping.instance_name.startswith('chatwoot_') %}
        <span class="badge badge-primary" style="background-color: #1f93ff;">Chatwoot</span>
        {% elif mapping.platform_token %}
        <span class="badge badge-telegram">Telegram</span>
        {% else %}
        <span class="badge badge-evolution">Evolution</span>
        {% endif %}
    </td>
    <td style="font-family: monospace; font-size: 0.9em; color: var(--text-muted);">{{ mapping.tenant_id[:8] }}...</td>
    <td style="font-family: monospace;">{{ mapping.access_key or '-' }}</td>
    <td style="text-align: right;">
        <button class="btn btn-sm btn-danger" hx-delete="/admin/mappings/{{ mapping.instance_name }}"
            hx-target="closest tr" hx-swap="outerHTML" onclick="return confirm('Are you sure?')">
            Delete
        </button>
    </td>
</tr>