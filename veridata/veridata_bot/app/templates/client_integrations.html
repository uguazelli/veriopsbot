{% extends "base.html" %}

{% block title %}Client Integrations - {{ client.name }}{% endblock %}

{% block content %}
<div class="top-nav">
    <div style="font-weight: bold; font-size: 1.2rem;">Veridata Bot Admin</div>
    <div class="nav-links">
        <a href="/admin/clients">Back to Clients</a>
    </div>
</div>

<div class="container" style="margin-top: 60px;">
    <h1>Integrations for {{ client.name }}</h1>

    <div class="card" style="margin-bottom: 2rem;">
        <h3>Chatwoot Configuration</h3>
        <form hx-post="/admin/clients/{{ client.id }}/integrations/chatwoot" hx-swap="none">
            {% set cw = integrations.get('chatwoot', {}) %}
            <div>
                <label>URL</label>
                <input type="text" name="url" value="{{ cw.get('url', '') }}"
                    placeholder="https://chatwoot.example.com">
            </div>
            <div>
                <label>API Token</label>
                <input type="text" name="api_token" value="{{ cw.get('api_token', '') }}">
            </div>
            <div>
                <label>Account ID</label>
                <input type="text" name="account_id" value="{{ cw.get('account_id', '') }}">
            </div>
            <button type="submit" style="margin-top: 1rem;">Save Chatwoot config</button>
        </form>
    </div>

    <div class="card" style="margin-bottom: 2rem;">
        <h3>EspoCRM Configuration</h3>
        <form hx-post="/admin/clients/{{ client.id }}/integrations/espocrm" hx-swap="none">
            {% set espo = integrations.get('espocrm', {}) %}
            <div>
                <label>URL</label>
                <input type="text" name="url" value="{{ espo.get('url', '') }}"
                    placeholder="https://espocrm.example.com">
            </div>
            <div>
                <label>API Key</label>
                <input type="text" name="api_key" value="{{ espo.get('api_key', '') }}">
            </div>
            <button type="submit" style="margin-top: 1rem;">Save EspoCRM config</button>
        </form>
    </div>

    <div class="card" style="margin-bottom: 2rem;">
        <h3>RAG Configuration</h3>
        <form hx-post="/admin/clients/{{ client.id }}/integrations/rag" hx-swap="none">
            {% set rag = integrations.get('rag', {}) %}
            <div>
                <label>RAG URL</label>
                <input type="text" name="url" value="{{ rag.get('url', '') }}"
                    placeholder="http://veridata.rag:8000/api/query">
            </div>
            <div>
                <label>RAG Tenant ID</label>
                <input type="text" name="tenant_id" value="{{ rag.get('tenant_id', '') }}" placeholder="UUID">
            </div>
            <div>
                <label>Provider</label>
                <input type="text" name="provider" value="{{ rag.get('provider', 'gemini') }}" placeholder="gemini">
            </div>
            <div>
                <label>API Key (Optional)</label>
                <input type="text" name="api_key" value="{{ rag.get('api_key', '') }}">
            </div>
            <button type="submit" style="margin-top: 1rem;">Save RAG config</button>
        </form>
    </div>
</div>
{% endblock %}